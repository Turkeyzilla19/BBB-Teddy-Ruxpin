import Adafruit_BBIO.GPIO as GPIO
from time import sleep 
import sys
import termios
import tty

enM = "P8_7"
enE = "P8_9"
ain1Pin = "P8_8"
ain2Pin = "P8_10"
ain3Pin = "P8_12"
ain4Pin = "P8_14"

GPIO.setup(enM, GPIO.OUT)
GPIO.setup(enE, GPIO.OUT)
GPIO.setup(ain1Pin, GPIO.OUT)
GPIO.setup(ain2Pin, GPIO.OUT)
GPIO.setup(ain3Pin, GPIO.OUT)
GPIO.setup(ain4Pin, GPIO.OUT)

GPIO.output(enM, GPIO.HIGH)
GPIO.output(enE, GPIO.HIGH)

def getKey():
  fd = sys.stdin.fileno()
  old = termios.tcgetattr(fd)
  new = termios.tcgetattr(fd)
  new[3] = new[3] & ~termios.ICANON & ~termios.ECHO
  new[6][termios.VMIN] = 1
  new[6][termios.VTIME] = 0
  termios.tcsetattr(fd, termios.TCSANOW, new)
  key = NONE
  try:
    key = os.read(fd, 3)
  finally:
    termios.tcsetattr(fd, termios.TCSAFLUSH, old)
   return key

while 1: 
  x = str(getKey())
  if x == "w":
    GPIO.output(ain2Pin, GPIO.LOW)
    GPIO.output(ain1Pin, GPIO.HIGH)
  elif x == "s":
    GPIO.output(ain1Pin, GPIO.LOW)
    GPIO.output(ain2Pin, GPIO.HIGH)
  elif x == "a":
    GPIO.output(ain3Pin, GPIO.LOW)
    GPIO.output(ain4Pin, GPIO.HIGH)
  elif x == "d":
    GPIO.output(ain4Pin, GPIO.LOW)
    GPIO.output(ain3Pin, GPIO.HIGH)
